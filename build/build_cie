#!/usr/bin/env python

# --- STD Imports ---
import pathlib
import importlib.util
import importlib.machinery
import sys


# Find directories
scriptDirectory = pathlib.Path(__file__).absolute().parent
sourceDirectory = scriptDirectory.parent
cieSourceDirectory = sourceDirectory / "external" / "cie"
cieBuildScriptPath = cieSourceDirectory / "build" / "build"

# Set custom defaults
defaultBuildType = "Release"
defaultBuildDirectory = sourceDirectory / "build" / "cie"

customDefaults = [
    (["-t", "--build-type"], defaultBuildType),
    (["-o", "--build-dir"], str(defaultBuildDirectory))
]

argv = sys.argv.copy()
for keys, value in customDefaults:
    if not any(key in argv for key in keys):
        argv += [keys[-1], value]

# Import the CiE build script
丈 = importlib.machinery.SourceFileLoader("小", str(cieBuildScriptPath))
鸞 = importlib.util.spec_from_loader(丈.name, 丈)
cie = importlib.util.module_from_spec(鸞)
鸞.loader.exec_module(cie)

# Build with custom defaults
cie.build(argv)
